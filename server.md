# Сервер QSystem #

## Запуск. ##

Запуск осуществляется из командной строки. Для удобства создается командный файл, ярлык можно поместить в любое место и запускать двойным щелчком мыши. При использовании инсталляционного пакета можно указать создание такого ярлыка на рабочем столе автоматически. После запуска сервера в консольном окне будет выведено сообщение «Сервер системы запущен» и будет производится индикация активности сервера. Для того чтобы главное табло не раскрывалось на весь экран, производите страт сервера с ключом debug. Так же главное табло вообще можно отключить, настраивается в конфигурационном файле главного табло config\mainboard.xml в параметре visible=0/1. Внимание, при закрыти окна главного табло автоматически выключается сервер суо.

В состав сервера суо QSystem  входит HTTP-сервер. По умолчанию запуск HTTP-сервера отключен т.к. он нужен не всем пользователям. Чтобы HTTP-сервер запустился одновременно с сервером суо QSystem, необходимо производить старт сервера QSystem с ключом -http 8081. Тут 8081 это номер порта на котором HTTP-сервер будет работать. HTTP-сервер принимает соединения по следующим адресам:

  * qsystem/ws - поддержка вебсокетов
  * qsystem/info - получить информацию о сервере суо
  * qsystem/command - команды API управления и взаимодействия с QSystem
Останов сервера.

Для штатного завершения работы сервера необходимо в консольном окне набрать команду «exit». В этом случае сервер выключает главное табло, останавливает запущенные сервисы и освобождает все ресурсы. Вся текущая обстановка стирается, временные файлы в папке temp удаляются. Все счетчики и значения сбрасываются в первоначальные значения.

## Встроенный HTTP сервер. ##

Для того чтобы при старте сервера запустился Jetty, это http сервер, необходимо указать ключ -http <порт>. Например, ключ -http 8081 укажет серверу о необходимости старта Jetty на порту 8081. После старта сервера можно использовать http запросы к серверу, использовать QSystem для размещения контента. Работает вебсокет. WebSocket url /qsystem/ws. URL для команд /qsystem/command, для получения информации по серверу /qsystem/info. Для теста локально откройте в браузере http://localhost:8081/qsystem/info. Откроется страница с информацией о версиях базы данных и самой суо.

## Надежность. ##

При нештатном завершении работы, например при программной или аппаратной ошибке, вновь запущенный сервер будет иметь состояние, которое было на момент нештатного завершения работы. Это же произойдет при завершении работы без команды «exit». При падении сервера вся текущая обстановка остается во временных файлах в папке temp.

## Вывод информации. ##

Сервер выводит всю информацию о движении очереди на главное табло. Главное табло имеет богатые настройки для вывода как основной информации, так и сопутствующей. Например графических изображений, видеороликов, HTML-текста, бегущей строки, текущего времени.

## Необходимые условия для запуска ##

Сервер системы использует СУБД MySQL5.5 для своей работы. По этому перед началом эксплуатации установите СУБД MySQL5.5 если еще не была установлена и разверните базу данных sql-скриптом, который находится в папке db. Так же для визуализации используется фреймфорк JMF. Обязательно установите эту программу перед запуском любого компонента системы. Установщик JMF всегда есть в папке, в которую вы установили QSystem.