# Предварительная запись через интернет #

Предварительная запись через интернет реализована как отдельное вэбприложение. Это приложение работает под управлением сервера приложений Glassfish3.1 или более позднего. Предварительная запись через интернет полностью аналогична функцианалу на киоске регистрации. В работе приложение предварительной записи через интернет не требует отдельной базы данных или другого хранилища информации. Вся необходимия информация берется и отправляется напрямую в сервер СУО QSystem, так же как это делает пункт регистрации. Для этого используется API взаимодействия.

Общая схема работы выглядет следующем образом. Ставится отдельный компьютер, на нем разворачивается сервер приложений Glassfish3.1. В этот сервер устанавливается приложение предварительной записи. Производится настройка, в том числе указание для сервера приложений адреса и порта сервера СУО QSystem для взаимодействия. На сайте, с которого будет доступна предварительная регистрация, добавляется ссылка или баннер на вэбприложение. По щелчку мышью по этой ссылке открывается в отдельном окне форма предварительной записи, в которой пользователь выполняет все необходимые действия. По окончанию всех действий можно либо распечатать результат, либо просто записать на листе бумаги. Так же если был введен email, то на него будудет выслано письмо со всеми подробностями.

## Шаги развертывания предварительной записи через интернет: ##

Устанавливаем компьютер с выходом в интернет и постоянным IP адресом.
Настраиваем локальную сеть таким образом чтобы установленный компьютер смог соединяться по TCP с серверов СУО QSystem.
Проверяем безопастность. Закрываем все другие порты и адреса, которые не требуются для взаимодействия с сервером СУО. Настраиваем NAT таблицы для защиты доступа извне.
На установленный компьютер с выходом в интерент инсталируем Java7 и сервер приложений Glassfish3.1 или более поздний.
Скачиваем вэбприложение с Google Code. Это приложение имеет расширение war.
Устанавливаем скаченное вэбприложение в сервер приложений Glassfish.
Производим настройки, необходимые для приложения. См. картинки ниже.
На сайте компании на страницу, с которой будет доступ к предварительной записи для посетителей, добавляем баннер или просто ссылку на установленное ранее вэбприложение.
Итоговое тестирование. Система предварительной записи через интерент готова к работе.

## Настройка. ##

Настройка отправления результатов по почте. Имя ресурса JavaMail Sessions должно быть QSYSPREREG-MAIL

## Настройка параметров приложения: ##
В System properties добавляем следующие параметры:

  * QSYSPREREG\_CAPTION - заглавный текст на странице регистрации
  * QSYSPREREG\_TITLE - заголовок окна
  * QSYSTEM\_SERVER\_ADDR - адрес сервера СУО QSystem
  * QSYSTEM\_SERVER\_PORT  - порт сервера СУО QSystem